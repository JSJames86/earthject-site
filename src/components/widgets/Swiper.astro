---
// You will need to install swiper.js with `npm install swiper`
import 'swiper/css';
import 'swiper/css/navigation';
import 'swiper/css/pagination';
import 'swiper/css/effect-fade';

import Swiper from 'swiper';
import { Navigation, Pagination, EffectFade } from 'swiper/modules';

const uniqueId = 'swiper-' + Math.random().toString(36).substring(7);
---

<div class="relative w-full aspect-[4/3] sm:aspect-video overflow-hidden group">
  <div id={uniqueId} class="swiper h-full">
    <div class="swiper-wrapper">
      <!-- Slide 1: Image -->
      <div class="swiper-slide relative">
        <img
          src="/assets/images/hands-touching-a-tree-trunk.jpg"
          class="w-full h-full object-cover"
          alt="Hands touching a tree trunk."
        />
      </div>

      <!-- Slide 2: Image -->
      <div class="swiper-slide relative">
        <img
          src="/assets/images/tree-planting.jpg"
          class="w-full h-full object-cover"
          alt="Two people planting a tree."
        />
      </div>

      <!-- Slide 3: Image -->
        <img
          src="/assets/images/big-tree.jpg"
          class="w-full h-full object-cover"
          alt="A large, mature tree."
        />
      </div>

      <!-- Slide 4: Image -->
      <div class="swiper-slide relative">
        <img
          src="/assets/images/zero-waste-bag.jpg"
          class="w-full h-full object-cover"
          alt="A zero-waste grocery bag."
        />
      </div>

      <!-- Slide 5: Image -->
      <div class="swiper-slide relative">
        <img
          src="/assets/images/planting-crops.jpg"
          class="w-full h-full object-cover"
          alt="Hands planting a row of crops."
        />
      </div>
    </div>
    <!-- If we need pagination -->
    <div class="swiper-pagination"></div>

    <!-- If we need navigation buttons -->
    <div class="swiper-button-prev w-10 h-10 bg-white/50 rounded-full flex items-center justify-center transition-opacity duration-300 opacity-0 group-hover:opacity-100"></div>
    <div class="swiper-button-next w-10 h-10 bg-white/50 rounded-full flex items-center justify-center transition-opacity duration-300 opacity-0 group-hover:opacity-100"></div>
  </div>
</div>

<script>
  import 'swiper/css';
  import 'swiper/css/navigation';
  import 'swiper/css/pagination';
  import 'swiper/css/effect-fade';

  import Swiper from 'swiper';
  import { Navigation, Pagination, EffectFade } from 'swiper/modules';

  document.addEventListener('astro:load', () => {
    // We can now target the swiper directly, without a unique ID, which is more reliable.
    const swiper = document.getElementById('{uniqueId}');
    if (swiper) {
      new Swiper(swiper, {
        modules: [Navigation, Pagination, EffectFade],
        effect: 'fade',
        loop: true,
        fadeEffect: {
          crossFade: true
        },
        // If we need pagination
        pagination: {
          el: '.swiper-pagination',
          clickable: true,
        },

        // Navigation arrows
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
      });
    }
  });
</script>
