---
import { getAsset } from '~/utils/permalinks';
import Layout from '~/layouts/PageLayout.astro';
import Header from '~/components/widgets/Header.astro';
import Footer from '~/components/widgets/Footer.astro';
import Swiper from '~/components/widgets/Swiper.astro';
import { headerData, footerData } from '~/navigation';

const metadata = {
  title: 'Earthject - Continuous Scroll Homepage',
};
---

<Layout metadata={metadata}>
  <!-- Sticky Header with Logo -->
  <Header
    {...headerData}
    id="sticky-header"
    isSticky={true}
  />
  
  <!-- Carousel Section -->
  <Swiper />
  
  <!-- Content Section 1 -->
  <section class="h-screen flex items-center justify-center p-8 bg-white text-black">
    <div class="max-w-4xl text-center">
      <h2 class="text-4xl md:text-6xl font-bold mb-4">Protecting Our Planet</h2>
      <p class="text-lg md:text-xl">
        At Earthject, we believe that every small action contributes to a healthier planet. Join our mission and make a difference.
      </p>
    </div>
  </section>

  <!-- Content Section 2 (with image background) -->
  <section class="h-screen relative flex items-center justify-center p-8 text-white" style=`background-image: url(${getAsset('/images/section-bg.jpg')}); background-size: cover; background-position: center;`>
    <div class="absolute inset-0 bg-black bg-opacity-50"></div>
    <div class="relative z-10 max-w-4xl text-center">
      <h2 class="text-4xl md:text-6xl font-bold mb-4">Community in Action</h2>
      <p class="text-lg md:text-xl">
        See how our community is making a real-world impact. From local cleanups to global initiatives, we're in this together.
      </p>
    </div>
  </section>

  <!-- Content Section 3 -->
  <section class="h-screen flex items-center justify-center p-8 bg-white text-black">
    <div class="max-w-4xl text-center">
      <h2 class="text-4xl md:text-6xl font-bold mb-4">Our Commitment</h2>
      <p class="text-lg md:text-xl">
        Earthject is dedicated to creating a sustainable future for generations to come. Your support helps us grow and expand our reach.
      </p>
    </div>
  </section>
  
  <Footer {...footerData} />
</Layout>

<script>
  // This script will handle the dynamic background of the sticky header
  const header = document.getElementById('sticky-header');
  const sections = document.querySelectorAll('section');

  function updateHeaderBackground() {
    let currentSection = null;
    sections.forEach(section => {
      const rect = section.getBoundingClientRect();
      if (rect.top <= 0 && rect.bottom >= 0) {
        currentSection = section;
      }
    });

    if (currentSection) {
      const isDarkBackground = window.getComputedStyle(currentSection).getPropertyValue('color') === 'rgb(255, 255, 255)';
      if (isDarkBackground) {
        header.style.backgroundColor = 'rgba(0, 0, 0, 0.7)'; // Dark, semi-transparent background
      } else {
        header.style.backgroundColor = 'rgba(255, 255, 255, 0.7)'; // Light, semi-transparent background
      }
    } else {
      header.style.backgroundColor = 'transparent';
    }
  }

  window.addEventListener('scroll', updateHeaderBackground);
  updateHeaderBackground();
</script>
